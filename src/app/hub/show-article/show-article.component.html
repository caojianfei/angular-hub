<div id="test-editormd"></div>
<section>
    <div class="row">
        <div class="col-md-9" *ngIf="article">
            <div class="background-white p-5 border">
                <div class="text-center mb-5">
                    <h1 class="mb-3">{{ article.title }}</h1>
                    <div class="">
                        <span class="mr-2">
                            <i class="fa fa-clock-o mr-1 font-small" aria-hidden="true"></i>
                            <span class="text-color-second number-small  pr-1">{{article.created_at}}</span>
                        </span>
                        <span class="mr-2">
                            <i class="fa fa-thumbs-o-up mr-1 font-small" aria-hidden="true"></i>
                            <span class="text-color-second number-small  pr-1">{{article.like_count}}</span>
                        </span>
                        <span class="mr-2">
                            <i class="fa fa-comment-o mr-1 font-small" aria-hidden="true"></i>
                            <span class="text-color-second number-small pr-1">{{ article.replay_count }}</span>
                        </span>

                        <span class="mr-2">
                            <i class="fa fa-eye mr-1 font-small" aria-hidden="true"></i>
                            <span class="text-color-second number-small">{{ article.view_count }}</span>
                        </span>
                    </div>
                </div>
                <div [appHtml]="article.content" id="articleContent"></div>
                <div class="article-options mt-4 text-color-second ">
                    <span class="edit cursor-pointer mr-3" routerLink="./update">
                        <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                    </span>
                    <span class="delete cursor-pointer mr-3">
                        <i class="fa fa-trash-o" aria-hidden="true"></i>
                    </span>
                    <span class="like cursor-pointer">
                        <i class="fa fa-thumbs-o-up" aria-hidden="true"></i>
                    </span>
                </div>

            </div>

            <!-- 回复框 -->
            <div class="mt-2 p-4 background-white border">

                <textarea class="form-control" rows="4" [(ngModel)]="comment" appAutoheight></textarea>

                <div class="d-flex justify-content-end mt-2">
                    <button type="button" class="btn btn-danger" (click)="submitCommit()">
                        <i class="fa fa-paper-plane" aria-hidden="true"></i>
                        回复
                    </button>
                </div>

                <div *ngIf="comment" class="comment-preview rounded p-3 mt-3">
                    <div [appHtml]="comment"></div>
                </div>

            </div>

            <!-- 回复列表 -->
            <div class="comment-list mt-4 background-white">

                <div class="px-4 py-1 border-bottom">
                    <span class="mr-1">{{ article.comments?.data.length ? article.comments?.data.length : '0' }}</span>
                    <span>条回复</span>
                </div>

                <div *ngIf="article.comments.data">
                    <div *ngFor="let comment of article.comments.data" class="comment-item border-bottom p-4">
                        <div class="media">
                            <img class="mr-3 rounded-circle" style="width: 45px;" src="{{ comment.user.avatar?.url ? comment.user.avatar.url : 'assets/images/avatar.jpg' }}"
                                alt="Generic placeholder image">
                            <div class="media-body">
                                <div class="mb-2">
                                    <span class="">Jeffrey</span>
                                    <span class="float-right cursor-pointer" data-toggle="modal" (click)="replayComment = comment.id" data-target="#exampleModalLong">
                                        <i class="fa fa-reply text-color-second" aria-hidden="true"></i>
                                    </span>
                                    <span class="d-block font-small text-color-second ">{{ comment.created_at }}</span>
                                </div>

                                <div [appHtml]="comment.content">

                                </div>

                                <div *ngIf="comment.replayComment" class="comment-replay p-1 mt-2 border rounded">
                                    <a href="#">@{{comment.replayComment.user.name}}：</a>
                                    <div class="d-inline" [appHtml]="comment.replayComment.content "></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <div class="col-md-3">
            <div class="background-white p-5">fsdfsf</div>
        </div>
    </div>
</section>

<!-- 
<p-dialog header="发表回复" [(visible)]="displayReplay" minWidth="400">
    <app-replay-article [replayArticle]="replayArticle" [replayComment]="replayComment" (createdComment)="createdComment($event)"></app-replay-article>
</p-dialog> -->

<!-- Modal -->
<div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">回复评论</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <textarea class="form-control" rows="4" [(ngModel)]="replayCommentContent" appAutoheight></textarea>
                <div *ngIf="replayCommentContent" class="comment-preview rounded p-3 mt-3">
                    <div [appHtml]="replayCommentContent"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-danger" (click)="submitReplayComment()">回复</button>
            </div>
        </div>
    </div>
</div>

<bootstrap-modal [options]="{'size': 'large', 'confirmButtonClass': 'btn-danger'}" (confirmed)="confirmed($event)" title="哈哈哈">
    <div class="modal-body">
        <textarea class="form-control" rows="4" [(ngModel)]="replayCommentContent" appAutoheight></textarea>
        <div *ngIf="replayCommentContent" class="comment-preview rounded p-3 mt-3">
            <div [appHtml]="replayCommentContent"></div>
        </div>
    </div>
</bootstrap-modal>

<button (click)="test()">测试modal</button>